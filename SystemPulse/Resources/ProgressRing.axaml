<ResourceDictionary xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:app="using:SystemPulse">

	<Design.PreviewWith>
		<StackPanel>
			<Border Padding="20">
				<app:ProgressRing StartAngle="120" SweepAngle="200" Value="50" Foreground="Red" BorderThickness="15" Width="100" Height="100" />
			</Border>
			<Border Padding="20">
				<app:ProgressRing IsIndeterminate="True" />
			</Border>
		</StackPanel>
	</Design.PreviewWith>

	<ControlTheme x:Key="{x:Type app:ProgressRing}" TargetType="app:ProgressRing">
		<Setter Property="Foreground" Value="{DynamicResource SystemAccentColor}"/>
		<Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseLowBrush}" />
		<Setter Property="BorderThickness" Value="5" />
		<Setter Property="Height" Value="25" />
		<Setter Property="Width" Value="25" />
		<Setter Property="Template">
			<ControlTemplate>
				<Panel x:Name="ProgressRingRoot">
					<Arc x:Name="Track"
						 Stroke="{TemplateBinding Background}"
						 StrokeThickness="{ReflectionBinding BorderThickness.Top, RelativeSource={RelativeSource Mode=TemplatedParent}}"
						 StartAngle="{ReflectionBinding StartAngle, RelativeSource={RelativeSource Mode=TemplatedParent}}" SweepAngle="{ReflectionBinding SweepAngle, RelativeSource={RelativeSource Mode=TemplatedParent}}"
						 StrokeLineCap="Round" />
					<Arc x:Name="Fill"
						 Stroke="{TemplateBinding Foreground}"
						 StrokeThickness="{ReflectionBinding BorderThickness.Left, RelativeSource={RelativeSource Mode=TemplatedParent}}"
						 StrokeLineCap="Round" />
				</Panel>
			</ControlTemplate>
		</Setter>

		<Style Selector="^:not(:indeterminate) /template/ Arc#Fill">
			<Setter Property="StartAngle" Value="{ReflectionBinding StartAngle, RelativeSource={RelativeSource Mode=TemplatedParent}}"/>
			<Setter Property="SweepAngle" Value="{ReflectionBinding ValueAngle, RelativeSource={RelativeSource Mode=TemplatedParent}}"/>
		</Style>

		<Style Selector="^[IsEnabled=True]:indeterminate /template/ Arc#Fill">
			<Style.Animations>
				<Animation Duration="0:0:5" Easing="LinearEasing" IterationCount="INFINITE" FillMode="Both">
					<KeyFrame Cue="0%">
						<Setter Property="StartAngle" Value="-720"/>
						<Setter Property="SweepAngle" Value="0"/>
					</KeyFrame>
					<KeyFrame Cue="12.5%">
						<Setter Property="StartAngle" Value="-540"/>
						<Setter Property="SweepAngle" Value="50"/>
					</KeyFrame>
					<KeyFrame Cue="25%">
						<Setter Property="StartAngle" Value="-360"/>
						<Setter Property="SweepAngle" Value="100"/>
					</KeyFrame>
					<KeyFrame Cue="32.5%">
						<Setter Property="StartAngle" Value="-180"/>
						<Setter Property="SweepAngle" Value="50"/>
					</KeyFrame>
					<KeyFrame Cue="50%">
						<Setter Property="StartAngle" Value="0"/>
						<Setter Property="SweepAngle" Value="5"/>
					</KeyFrame>
					<KeyFrame Cue="62.5%">
						<Setter Property="StartAngle" Value="180"/>
						<Setter Property="SweepAngle" Value="50"/>
					</KeyFrame>
					<KeyFrame Cue="75%">
						<Setter Property="StartAngle" Value="360"/>
						<Setter Property="SweepAngle" Value="100"/>
					</KeyFrame>
					<KeyFrame Cue="87.5%">
						<Setter Property="StartAngle" Value="540"/>
						<Setter Property="SweepAngle" Value="50"/>
					</KeyFrame>
					<KeyFrame Cue="100%">
						<Setter Property="StartAngle" Value="720"/>
						<Setter Property="SweepAngle" Value="0"/>
					</KeyFrame>
				</Animation>
			</Style.Animations>
		</Style>
	</ControlTheme>
</ResourceDictionary>
